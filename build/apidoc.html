<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="http://github.com/theSmaw/Caja-HTML-Sanitizer"

    >sanitizer (v0.1.3)</a>
</h1>
<h4>Caja's HTML Sanitizer as a Node.js module</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.sanitizer">module sanitizer</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.escape">
            function <span class="apidocSignatureSpan">sanitizer.</span>escape
            <span class="apidocSignatureSpan">(s)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.escapeAttrib">
            function <span class="apidocSignatureSpan">sanitizer.</span>escapeAttrib
            <span class="apidocSignatureSpan">(s)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.makeHtmlSanitizer">
            function <span class="apidocSignatureSpan">sanitizer.</span>makeHtmlSanitizer
            <span class="apidocSignatureSpan">(tagPolicy)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.makeSaxParser">
            function <span class="apidocSignatureSpan">sanitizer.</span>makeSaxParser
            <span class="apidocSignatureSpan">(handler)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.makeTagPolicy">
            function <span class="apidocSignatureSpan">sanitizer.</span>makeTagPolicy
            <span class="apidocSignatureSpan">( opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.normalizeRCData">
            function <span class="apidocSignatureSpan">sanitizer.</span>normalizeRCData
            <span class="apidocSignatureSpan">(rcdata)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.sanitize">
            function <span class="apidocSignatureSpan">sanitizer.</span>sanitize
            <span class="apidocSignatureSpan">(inputHtml, opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.sanitizeAttribs">
            function <span class="apidocSignatureSpan">sanitizer.</span>sanitizeAttribs
            <span class="apidocSignatureSpan">(tagName, attribs, opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.sanitizeWithPolicy">
            function <span class="apidocSignatureSpan">sanitizer.</span>sanitizeWithPolicy
            <span class="apidocSignatureSpan">(inputHtml, tagPolicy)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.unescapeEntities">
            function <span class="apidocSignatureSpan">sanitizer.</span>unescapeEntities
            <span class="apidocSignatureSpan">(s)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri">
            function <span class="apidocSignatureSpan">sanitizer.</span>uri
            <span class="apidocSignatureSpan">( rawScheme, rawCredentials, rawDomain, port, rawPath, rawQuery, rawFragment)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">sanitizer.</span>Sanitizer</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">sanitizer.</span>uri.prototype</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.sanitizer.Sanitizer">module sanitizer.Sanitizer</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.Sanitizer.escape">
            function <span class="apidocSignatureSpan">sanitizer.Sanitizer.</span>escape
            <span class="apidocSignatureSpan">(s)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.Sanitizer.escapeAttrib">
            function <span class="apidocSignatureSpan">sanitizer.Sanitizer.</span>escapeAttrib
            <span class="apidocSignatureSpan">(s)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.Sanitizer.makeHtmlSanitizer">
            function <span class="apidocSignatureSpan">sanitizer.Sanitizer.</span>makeHtmlSanitizer
            <span class="apidocSignatureSpan">(tagPolicy)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.Sanitizer.makeSaxParser">
            function <span class="apidocSignatureSpan">sanitizer.Sanitizer.</span>makeSaxParser
            <span class="apidocSignatureSpan">(handler)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.Sanitizer.makeTagPolicy">
            function <span class="apidocSignatureSpan">sanitizer.Sanitizer.</span>makeTagPolicy
            <span class="apidocSignatureSpan">( opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.Sanitizer.normalizeRCData">
            function <span class="apidocSignatureSpan">sanitizer.Sanitizer.</span>normalizeRCData
            <span class="apidocSignatureSpan">(rcdata)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.Sanitizer.sanitize">
            function <span class="apidocSignatureSpan">sanitizer.Sanitizer.</span>sanitize
            <span class="apidocSignatureSpan">(inputHtml, opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.Sanitizer.sanitizeAttribs">
            function <span class="apidocSignatureSpan">sanitizer.Sanitizer.</span>sanitizeAttribs
            <span class="apidocSignatureSpan">(tagName, attribs, opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.Sanitizer.sanitizeWithPolicy">
            function <span class="apidocSignatureSpan">sanitizer.Sanitizer.</span>sanitizeWithPolicy
            <span class="apidocSignatureSpan">(inputHtml, tagPolicy)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.Sanitizer.unescapeEntities">
            function <span class="apidocSignatureSpan">sanitizer.Sanitizer.</span>unescapeEntities
            <span class="apidocSignatureSpan">(s)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">sanitizer.</span>Sanitizer</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.sanitizer.uri">module sanitizer.uri</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.uri">
            function <span class="apidocSignatureSpan">sanitizer.</span>uri
            <span class="apidocSignatureSpan">( rawScheme, rawCredentials, rawDomain, port, rawPath, rawQuery, rawFragment)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.URI">
            function <span class="apidocSignatureSpan">sanitizer.uri.</span>URI
            <span class="apidocSignatureSpan">( rawScheme, rawCredentials, rawDomain, port, rawPath, rawQuery, rawFragment)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.collapse_dots">
            function <span class="apidocSignatureSpan">sanitizer.uri.</span>collapse_dots
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.create">
            function <span class="apidocSignatureSpan">sanitizer.uri.</span>create
            <span class="apidocSignatureSpan">(scheme, credentials, domain, port, path, query, fragment)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.parse">
            function <span class="apidocSignatureSpan">sanitizer.uri.</span>parse
            <span class="apidocSignatureSpan">(uriStr)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.resolve">
            function <span class="apidocSignatureSpan">sanitizer.uri.</span>resolve
            <span class="apidocSignatureSpan">(baseUri, relativeUri)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">sanitizer.uri.</span>utils</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.sanitizer.uri.prototype">module sanitizer.uri.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.checkParameterCache_">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>checkParameterCache_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.clone">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>clone
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.getAllParameters">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>getAllParameters
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.getCredentials">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>getCredentials
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.getDomain">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>getDomain
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.getFragment">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>getFragment
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.getParameterMap">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>getParameterMap
            <span class="apidocSignatureSpan">(paramNameUnescaped)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.getParameterValue">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>getParameterValue
            <span class="apidocSignatureSpan">(paramNameUnescaped)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.getParameterValues">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>getParameterValues
            <span class="apidocSignatureSpan">(paramNameUnescaped)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.getPath">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>getPath
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.getPort">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>getPort
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.getQuery">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>getQuery
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.getRawCredentials">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>getRawCredentials
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.getRawDomain">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>getRawDomain
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.getRawFragment">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>getRawFragment
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.getRawPath">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>getRawPath
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.getRawQuery">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>getRawQuery
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.getRawScheme">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>getRawScheme
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.getScheme">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>getScheme
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.hasCredentials">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>hasCredentials
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.hasDomain">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>hasDomain
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.hasFragment">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>hasFragment
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.hasPath">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>hasPath
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.hasPort">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>hasPort
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.hasQuery">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>hasQuery
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.hasScheme">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>hasScheme
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.removeParameter">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>removeParameter
            <span class="apidocSignatureSpan">(key)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.setAllParameters">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>setAllParameters
            <span class="apidocSignatureSpan">(params)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.setCredentials">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>setCredentials
            <span class="apidocSignatureSpan">(newCredentials)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.setDomain">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>setDomain
            <span class="apidocSignatureSpan">(newDomain)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.setFragment">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>setFragment
            <span class="apidocSignatureSpan">(newFragment)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.setParameterValues">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>setParameterValues
            <span class="apidocSignatureSpan">(key, values)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.setPath">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>setPath
            <span class="apidocSignatureSpan">(newPath)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.setPort">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>setPort
            <span class="apidocSignatureSpan">(newPort)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.setQuery">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>setQuery
            <span class="apidocSignatureSpan">(newQuery)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.setRawCredentials">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>setRawCredentials
            <span class="apidocSignatureSpan">(newCredentials)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.setRawDomain">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>setRawDomain
            <span class="apidocSignatureSpan">(newDomain)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.setRawFragment">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>setRawFragment
            <span class="apidocSignatureSpan">(newFragment)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.setRawPath">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>setRawPath
            <span class="apidocSignatureSpan">(newPath)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.setRawQuery">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>setRawQuery
            <span class="apidocSignatureSpan">(newQuery)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.setRawScheme">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>setRawScheme
            <span class="apidocSignatureSpan">(newScheme)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.setScheme">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>setScheme
            <span class="apidocSignatureSpan">(newScheme)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sanitizer.uri.prototype.toString">
            function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>toString
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.sanitizer" id="apidoc.module.sanitizer">module sanitizer</a></h1>


    <h2>
        <a href="#apidoc.element.sanitizer.escape" id="apidoc.element.sanitizer.escape">
        function <span class="apidocSignatureSpan">sanitizer.</span>escape
        <span class="apidocSignatureSpan">(s)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function escapeAttrib(s) {
	if(s) {
	    return (&#x27;&#x27; + s).replace(ampRe, &#x27;&#x26;amp;&#x27;).replace(ltRe, &#x27;&#x26;lt;&#x27;)
        .replace(gtRe, &#x27;&#x26;gt;&#x27;).replace(quotRe, &#x27;&#x26;#34;&#x27;);
	}
	else {
	    return s;
	}

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```

## Use

See /test/test-sanitzer.js for full documentation.

```
sanitizer.<span class="apidocCodeKeywordSpan">escape</span>(&#x27;your dirty string&#x27;); // Escapes HTML special characters in
 attribute values as HTML entities
```

```
var yourParser = sanitizer.makeSaxParser(yourHandler); // Given a SAX-like event handler, produce a function that feeds those events
 and a parameter to the event handler.
```

```
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.escapeAttrib" id="apidoc.element.sanitizer.escapeAttrib">
        function <span class="apidocSignatureSpan">sanitizer.</span>escapeAttrib
        <span class="apidocSignatureSpan">(s)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function escapeAttrib(s) {
	if(s) {
	    return (&#x27;&#x27; + s).replace(ampRe, &#x27;&#x26;amp;&#x27;).replace(ltRe, &#x27;&#x26;lt;&#x27;)
        .replace(gtRe, &#x27;&#x26;gt;&#x27;).replace(quotRe, &#x27;&#x26;#34;&#x27;);
	}
	else {
	    return s;
	}

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.makeHtmlSanitizer" id="apidoc.element.sanitizer.makeHtmlSanitizer">
        function <span class="apidocSignatureSpan">sanitizer.</span>makeHtmlSanitizer
        <span class="apidocSignatureSpan">(tagPolicy)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function makeHtmlSanitizer(tagPolicy) {
    var stack;
    var ignoring;
    var emit = function (text, out) {
        if (!ignoring) { out.push(text); }
    };
    return makeSaxParser({
        &#x27;startDoc&#x27;: function(_) {
            stack = [];
            ignoring = false;
        },
        &#x27;startTag&#x27;: function(tagNameOrig, attribs, out) {
            if (ignoring) { return; }
            if (!html4.ELEMENTS.hasOwnProperty(tagNameOrig)) { return; }
            var eflagsOrig = html4.ELEMENTS[tagNameOrig];
            if (eflagsOrig &#x26; html4.eflags[&#x27;FOLDABLE&#x27;]) {
                return;
            }

            var decision = tagPolicy(tagNameOrig, attribs);
            if (!decision) {
                ignoring = !(eflagsOrig &#x26; html4.eflags[&#x27;EMPTY&#x27;]);
                return;
            } else if (typeof decision !== &#x27;object&#x27;) {
                throw new Error(&#x27;tagPolicy did not return object (old API?)&#x27;);
            }
            if (&#x27;attribs&#x27; in decision) {
                attribs = decision[&#x27;attribs&#x27;];
            } else {
                throw new Error(&#x27;tagPolicy gave no attribs&#x27;);
            }
            var eflagsRep;
            var tagNameRep;
            if (&#x27;tagName&#x27; in decision) {
                tagNameRep = decision[&#x27;tagName&#x27;];
                eflagsRep = html4.ELEMENTS[tagNameRep];
            } else {
                tagNameRep = tagNameOrig;
                eflagsRep = eflagsOrig;
            }
            // TODO(mikesamuel): relying on tagPolicy not to insert unsafe
            // attribute names.

            // If this is an optional-end-tag element and either this element or its
            // previous like sibling was rewritten, then insert a close tag to
            // preserve structure.
            if (eflagsOrig &#x26; html4.eflags[&#x27;OPTIONAL_ENDTAG&#x27;]) {
                var onStack = stack[stack.length - 1];
                if (onStack &#x26;&#x26; onStack.orig === tagNameOrig &#x26;&#x26;
                    (onStack.rep !== tagNameRep || tagNameOrig !== tagNameRep)) {
                    out.push(&#x27;&#x3c;\/&#x27;, onStack.rep, &#x27;&#x3e;&#x27;);
                }
            }

            if (!(eflagsOrig &#x26; html4.eflags[&#x27;EMPTY&#x27;])) {
                stack.push({orig: tagNameOrig, rep: tagNameRep});
            }

            out.push(&#x27;&#x3c;&#x27;, tagNameRep);
            for (var i = 0, n = attribs.length; i &#x3c; n; i += 2) {
                var attribName = attribs[i],
                    value = attribs[i + 1];
                if (value !== null &#x26;&#x26; value !== void 0) {
                    out.push(&#x27; &#x27;, attribName, &#x27;=&#x22;&#x27;, escapeAttrib(value), &#x27;&#x22;&#x27;);
                }
            }
            out.push(&#x27;&#x3e;&#x27;);

            if ((eflagsOrig &#x26; html4.eflags[&#x27;EMPTY&#x27;])
                &#x26;&#x26; !(eflagsRep &#x26; html4.eflags[&#x27;EMPTY&#x27;])) {
                // replacement is non-empty, synthesize end tag
                out.push(&#x27;&#x3c;\/&#x27;, tagNameRep, &#x27;&#x3e;&#x27;);
            }
        },
        &#x27;endTag&#x27;: function(tagName, out) {
            if (ignoring) {
                ignoring = false;
                return;
            }
            if (!html4.ELEMENTS.hasOwnProperty(tagName)) { return; }
            var eflags = html4.ELEMENTS[tagName];
            if (!(eflags &#x26; (html4.eflags[&#x27;EMPTY&#x27;] | html4.eflags[&#x27;FOLDABLE&#x27;]))) {
                var index;
                if (eflags &#x26; html4.eflags[&#x27;OPTIONAL_ENDTAG&#x27;]) {
                    for (index = stack.length; --index &#x3e;= 0;) {
                        var stackElOrigTag = stack[index].orig;
                        if (stackElOrigTag === tagName) { break; }
                        if (!(html4.ELEMENTS[stackElOrigTag] &#x26;
                            html4.eflags[&#x27;OPTIONAL_ENDTAG&#x27;])) {
                            // Don&#x27;t pop non optional end tags looking for a match.
                            return;
                        }
                    }
                } else {
                    for (index = stack.length; --index &#x3e;= 0;) {
                        if (stack[index].orig === tagName) { break; }
                    }
                }
                if (index &#x3c; 0) { return; }  // Not opened.
                for (var i = stack ...</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.makeSaxParser" id="apidoc.element.sanitizer.makeSaxParser">
        function <span class="apidocSignatureSpan">sanitizer.</span>makeSaxParser
        <span class="apidocSignatureSpan">(handler)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function makeSaxParser(handler) {
    // Accept quoted or unquoted keys (Closure compat)
    var hcopy = {
        cdata: handler.cdata || handler[&#x27;cdata&#x27;],
        comment: handler.comment || handler[&#x27;comment&#x27;],
        endDoc: handler.endDoc || handler[&#x27;endDoc&#x27;],
        endTag: handler.endTag || handler[&#x27;endTag&#x27;],
        pcdata: handler.pcdata || handler[&#x27;pcdata&#x27;],
        rcdata: handler.rcdata || handler[&#x27;rcdata&#x27;],
        startDoc: handler.startDoc || handler[&#x27;startDoc&#x27;],
        startTag: handler.startTag || handler[&#x27;startTag&#x27;]
    };
    return function(htmlText, param) {
        return parse(htmlText, hcopy, param);
    };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
See /test/test-sanitzer.js for full documentation.

```
sanitizer.escape(&#x27;your dirty string&#x27;); // Escapes HTML special characters in attribute values as HTML entities
```

```
var yourParser = sanitizer.<span class="apidocCodeKeywordSpan">makeSaxParser</span>(yourHandler); // Given a SAX-like event handler
, produce a function that feeds those events and a parameter to the event handler.
```

```
sanitizer.normalizeRCData(&#x27;your dirty string&#x27;); // Escape entities in RCDATA that can be escaped without changing the
meaning.
```

```
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.makeTagPolicy" id="apidoc.element.sanitizer.makeTagPolicy">
        function <span class="apidocSignatureSpan">sanitizer.</span>makeTagPolicy
        <span class="apidocSignatureSpan">( opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function makeTagPolicy( opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger) {
    return function(tagName, attribs) {
        if (!(html4.ELEMENTS[tagName] &#x26; html4.eflags[&#x27;UNSAFE&#x27;])) {
            return {
                &#x27;attribs&#x27;: sanitizeAttribs(tagName, attribs,
                    opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger)
            };
        } else {
            if (opt_logger) {
                log(opt_logger, tagName, undefined, undefined, undefined);
            }
        }
    };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.normalizeRCData" id="apidoc.element.sanitizer.normalizeRCData">
        function <span class="apidocSignatureSpan">sanitizer.</span>normalizeRCData
        <span class="apidocSignatureSpan">(rcdata)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function normalizeRCData(rcdata) {
	if(rcdata) {
	    return rcdata
            .replace(looseAmpRe, &#x27;&#x26;amp;$1&#x27;)
            .replace(ltRe, &#x27;&#x26;lt;&#x27;)
            .replace(gtRe, &#x27;&#x26;gt;&#x27;);
	}
	else {
	    return rcdata;
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```

```
var yourParser = sanitizer.makeSaxParser(yourHandler); // Given a SAX-like event handler, produce a function that feeds those events
 and a parameter to the event handler.
```

```
sanitizer.<span class="apidocCodeKeywordSpan">normalizeRCData</span>(&#x27;your dirty string&#x27;); // Escape entities in RCDATA
 that can be escaped without changing the meaning.
```

```
sanitizer.sanitize(&#x27;your dirty string&#x27;); // Strips unsafe tags and attributes from html.
```

```
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.sanitize" id="apidoc.element.sanitizer.sanitize">
        function <span class="apidocSignatureSpan">sanitizer.</span>sanitize
        <span class="apidocSignatureSpan">(inputHtml, opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sanitize = function (inputHtml, opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger) {
    if (typeof(inputHtml) === &#x22;string&#x22;) {
        inputHtml = inputHtml.replace(/&#x3c;([a-zA-Z]+)([^&#x3e;]*)\/&#x3e;/g, &#x27;&#x3c;$1$2&#x3e;&#x3c;/$1&#x3e;&#x27;);
    }

    if (inputHtml) {
        return html.sanitize(inputHtml, opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger);
    }
    else {
        return inputHtml;
    }

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```

```
sanitizer.normalizeRCData(&#x27;your dirty string&#x27;); // Escape entities in RCDATA that can be escaped without changing the
meaning.
```

```
sanitizer.<span class="apidocCodeKeywordSpan">sanitize</span>(&#x27;your dirty string&#x27;); // Strips unsafe tags and attributes
 from html.
```

```
exports.unescapeEntities(&#x27;your string&#x27;); // The plain text of a chunk of HTML CDATA which possibly containing.
```

## Caveats
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.sanitizeAttribs" id="apidoc.element.sanitizer.sanitizeAttribs">
        function <span class="apidocSignatureSpan">sanitizer.</span>sanitizeAttribs
        <span class="apidocSignatureSpan">(tagName, attribs, opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function sanitizeAttribs(tagName, attribs, opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger) {
    // TODO(felix8a): it&#x27;s obnoxious that domado duplicates much of this
    // TODO(felix8a): maybe consistently enforce constraints like target=
    for (var i = 0; i &#x3c; attribs.length; i += 2) {
        var attribName = attribs[i];
        var value = attribs[i + 1];
        var oldValue = value;
        var atype = null, attribKey;
        if ((attribKey = tagName + &#x27;::&#x27; + attribName,
            html4.ATTRIBS.hasOwnProperty(attribKey)) ||
            (attribKey = &#x27;*::&#x27; + attribName,
                html4.ATTRIBS.hasOwnProperty(attribKey))) {
            atype = html4.ATTRIBS[attribKey];
        }
        if (atype !== null) {
            switch (atype) {
                case html4.atype[&#x27;NONE&#x27;]: break;
                case html4.atype[&#x27;SCRIPT&#x27;]:
                    value = null;
                    if (opt_logger) {
                        log(opt_logger, tagName, attribName, oldValue, value);
                    }
                    break;
                case html4.atype[&#x27;STYLE&#x27;]:
                    if (&#x27;undefined&#x27; === typeof parseCssDeclarations) {
                        value = null;
                        if (opt_logger) {
                            log(opt_logger, tagName, attribName, oldValue, value);
                        }
                        break;
                    }
                    var sanitizedDeclarations = [];
                    parseCssDeclarations(
                        value,
                        {
                            &#x27;declaration&#x27;: function (property, tokens) {
                                var normProp = property.toLowerCase();
                                sanitizeCssProperty(
                                    normProp, tokens,
                                    opt_naiveUriRewriter
                                        ? function (url) {
                                        return safeUri(
                                            url, html4.ueffects.SAME_DOCUMENT,
                                            html4.ltypes.SANDBOXED,
                                            {
                                                &#x22;TYPE&#x22;: &#x22;CSS&#x22;,
                                                &#x22;CSS_PROP&#x22;: normProp
                                            }, opt_naiveUriRewriter);
                                    }
                                        : null);
                                if (tokens.length) {
                                    sanitizedDeclarations.push(
                                        normProp + &#x27;: &#x27; + tokens.join(&#x27; &#x27;));
                                }
                            }
                        });
                    value = sanitizedDeclarations.length &#x3e; 0 ?
                        sanitizedDeclarations.join(&#x27; ; &#x27;) : null;
                    if (opt_logger) {
                        log(opt_logger, tagName, attribName, oldValue, value);
                    }
                    break;
                case html4.atype[&#x27;ID&#x27;]:
                case html4.atype[&#x27;IDREF&#x27;]:
                case html4.atype[&#x27;IDREFS&#x27;]:
                case html4.atype[&#x27;GLOBAL_NAME&#x27;]:
                case html4.atype[&#x27;LOCAL_NAME&#x27;]:
                case html4.atype[&#x27;CLASSES&#x27;]:
                    value = opt_nmTokenPolicy ? opt_nmTokenPolicy(value) : value;
                    if (opt_logger) {
                        log(opt_logger, tagName, attribName, oldValue, value);
                    }
                    break;
                case html4.atype[&#x27;URI&#x27;]:
                    value = safeUri(value,
                        getUriEffect(tagName, attribName),
                        getLoaderType(tagName, attribName),
                        {
                            &#x22;TYPE&#x22;: &#x22;MARKUP&#x22;,
                            &#x22;XML_ATTR&#x22;: attribName,
                            &#x22;XML_TAG&#x22;: tagName
                        }, opt_naiveUriRewriter);
                    if (opt_logger) {
                        log(opt_logger, tagName, attribName, o ...</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.sanitizeWithPolicy" id="apidoc.element.sanitizer.sanitizeWithPolicy">
        function <span class="apidocSignatureSpan">sanitizer.</span>sanitizeWithPolicy
        <span class="apidocSignatureSpan">(inputHtml, tagPolicy)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function sanitizeWithPolicy(inputHtml, tagPolicy) {
    var outputArray = [];
    makeHtmlSanitizer(tagPolicy)(inputHtml, outputArray);
    return outputArray.join(&#x27;&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.unescapeEntities" id="apidoc.element.sanitizer.unescapeEntities">
        function <span class="apidocSignatureSpan">sanitizer.</span>unescapeEntities
        <span class="apidocSignatureSpan">(s)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function unescapeEntities(s) {
	if(s) {
	    return s.replace(ENTITY_RE_1, decodeOneEntity);
	}
	else {
	    return s;
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```

```
sanitizer.sanitize(&#x27;your dirty string&#x27;); // Strips unsafe tags and attributes from html.
```

```
exports.<span class="apidocCodeKeywordSpan">unescapeEntities</span>(&#x27;your string&#x27;); // The plain text of a chunk of HTML
 CDATA which possibly containing.
```

## Caveats

It&#x27;s use this at your own risk really - Caja HTML Sanitizer was written by people far cleverer than me. I have just repackaged
 it to solve a problem I had (sanitization on a Node server). It seems to work, and it passes all its tests in re-packaged form -
however I don&#x27;t fully understand its internals so cannot guarantee its security.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri" id="apidoc.element.sanitizer.uri">
        function <span class="apidocSignatureSpan">sanitizer.</span>uri
        <span class="apidocSignatureSpan">( rawScheme, rawCredentials, rawDomain, port, rawPath, rawQuery, rawFragment)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function URI( rawScheme, rawCredentials, rawDomain, port, rawPath, rawQuery, rawFragment) {
    this.scheme_ = rawScheme;
    this.credentials_ = rawCredentials;
    this.domain_ = rawDomain;
    this.port_ = port;
    this.path_ = rawPath;
    this.query_ = rawQuery;
    this.fragment_ = rawFragment;
<span class="apidocCodeCommentSpan">    /**
     * @type {Array|null}
     */
</span>    this.paramCache_ = null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>






</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.sanitizer.Sanitizer" id="apidoc.module.sanitizer.Sanitizer">module sanitizer.Sanitizer</a></h1>


    <h2>
        <a href="#apidoc.element.sanitizer.Sanitizer.escape" id="apidoc.element.sanitizer.Sanitizer.escape">
        function <span class="apidocSignatureSpan">sanitizer.Sanitizer.</span>escape
        <span class="apidocSignatureSpan">(s)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function escapeAttrib(s) {
	if(s) {
	    return (&#x27;&#x27; + s).replace(ampRe, &#x27;&#x26;amp;&#x27;).replace(ltRe, &#x27;&#x26;lt;&#x27;)
        .replace(gtRe, &#x27;&#x26;gt;&#x27;).replace(quotRe, &#x27;&#x26;#34;&#x27;);
	}
	else {
	    return s;
	}

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```

## Use

See /test/test-sanitzer.js for full documentation.

```
sanitizer.<span class="apidocCodeKeywordSpan">escape</span>(&#x27;your dirty string&#x27;); // Escapes HTML special characters in
 attribute values as HTML entities
```

```
var yourParser = sanitizer.makeSaxParser(yourHandler); // Given a SAX-like event handler, produce a function that feeds those events
 and a parameter to the event handler.
```

```
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.Sanitizer.escapeAttrib" id="apidoc.element.sanitizer.Sanitizer.escapeAttrib">
        function <span class="apidocSignatureSpan">sanitizer.Sanitizer.</span>escapeAttrib
        <span class="apidocSignatureSpan">(s)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function escapeAttrib(s) {
	if(s) {
	    return (&#x27;&#x27; + s).replace(ampRe, &#x27;&#x26;amp;&#x27;).replace(ltRe, &#x27;&#x26;lt;&#x27;)
        .replace(gtRe, &#x27;&#x26;gt;&#x27;).replace(quotRe, &#x27;&#x26;#34;&#x27;);
	}
	else {
	    return s;
	}

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.Sanitizer.makeHtmlSanitizer" id="apidoc.element.sanitizer.Sanitizer.makeHtmlSanitizer">
        function <span class="apidocSignatureSpan">sanitizer.Sanitizer.</span>makeHtmlSanitizer
        <span class="apidocSignatureSpan">(tagPolicy)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function makeHtmlSanitizer(tagPolicy) {
    var stack;
    var ignoring;
    var emit = function (text, out) {
        if (!ignoring) { out.push(text); }
    };
    return makeSaxParser({
        &#x27;startDoc&#x27;: function(_) {
            stack = [];
            ignoring = false;
        },
        &#x27;startTag&#x27;: function(tagNameOrig, attribs, out) {
            if (ignoring) { return; }
            if (!html4.ELEMENTS.hasOwnProperty(tagNameOrig)) { return; }
            var eflagsOrig = html4.ELEMENTS[tagNameOrig];
            if (eflagsOrig &#x26; html4.eflags[&#x27;FOLDABLE&#x27;]) {
                return;
            }

            var decision = tagPolicy(tagNameOrig, attribs);
            if (!decision) {
                ignoring = !(eflagsOrig &#x26; html4.eflags[&#x27;EMPTY&#x27;]);
                return;
            } else if (typeof decision !== &#x27;object&#x27;) {
                throw new Error(&#x27;tagPolicy did not return object (old API?)&#x27;);
            }
            if (&#x27;attribs&#x27; in decision) {
                attribs = decision[&#x27;attribs&#x27;];
            } else {
                throw new Error(&#x27;tagPolicy gave no attribs&#x27;);
            }
            var eflagsRep;
            var tagNameRep;
            if (&#x27;tagName&#x27; in decision) {
                tagNameRep = decision[&#x27;tagName&#x27;];
                eflagsRep = html4.ELEMENTS[tagNameRep];
            } else {
                tagNameRep = tagNameOrig;
                eflagsRep = eflagsOrig;
            }
            // TODO(mikesamuel): relying on tagPolicy not to insert unsafe
            // attribute names.

            // If this is an optional-end-tag element and either this element or its
            // previous like sibling was rewritten, then insert a close tag to
            // preserve structure.
            if (eflagsOrig &#x26; html4.eflags[&#x27;OPTIONAL_ENDTAG&#x27;]) {
                var onStack = stack[stack.length - 1];
                if (onStack &#x26;&#x26; onStack.orig === tagNameOrig &#x26;&#x26;
                    (onStack.rep !== tagNameRep || tagNameOrig !== tagNameRep)) {
                    out.push(&#x27;&#x3c;\/&#x27;, onStack.rep, &#x27;&#x3e;&#x27;);
                }
            }

            if (!(eflagsOrig &#x26; html4.eflags[&#x27;EMPTY&#x27;])) {
                stack.push({orig: tagNameOrig, rep: tagNameRep});
            }

            out.push(&#x27;&#x3c;&#x27;, tagNameRep);
            for (var i = 0, n = attribs.length; i &#x3c; n; i += 2) {
                var attribName = attribs[i],
                    value = attribs[i + 1];
                if (value !== null &#x26;&#x26; value !== void 0) {
                    out.push(&#x27; &#x27;, attribName, &#x27;=&#x22;&#x27;, escapeAttrib(value), &#x27;&#x22;&#x27;);
                }
            }
            out.push(&#x27;&#x3e;&#x27;);

            if ((eflagsOrig &#x26; html4.eflags[&#x27;EMPTY&#x27;])
                &#x26;&#x26; !(eflagsRep &#x26; html4.eflags[&#x27;EMPTY&#x27;])) {
                // replacement is non-empty, synthesize end tag
                out.push(&#x27;&#x3c;\/&#x27;, tagNameRep, &#x27;&#x3e;&#x27;);
            }
        },
        &#x27;endTag&#x27;: function(tagName, out) {
            if (ignoring) {
                ignoring = false;
                return;
            }
            if (!html4.ELEMENTS.hasOwnProperty(tagName)) { return; }
            var eflags = html4.ELEMENTS[tagName];
            if (!(eflags &#x26; (html4.eflags[&#x27;EMPTY&#x27;] | html4.eflags[&#x27;FOLDABLE&#x27;]))) {
                var index;
                if (eflags &#x26; html4.eflags[&#x27;OPTIONAL_ENDTAG&#x27;]) {
                    for (index = stack.length; --index &#x3e;= 0;) {
                        var stackElOrigTag = stack[index].orig;
                        if (stackElOrigTag === tagName) { break; }
                        if (!(html4.ELEMENTS[stackElOrigTag] &#x26;
                            html4.eflags[&#x27;OPTIONAL_ENDTAG&#x27;])) {
                            // Don&#x27;t pop non optional end tags looking for a match.
                            return;
                        }
                    }
                } else {
                    for (index = stack.length; --index &#x3e;= 0;) {
                        if (stack[index].orig === tagName) { break; }
                    }
                }
                if (index &#x3c; 0) { return; }  // Not opened.
                for (var i = stack ...</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.Sanitizer.makeSaxParser" id="apidoc.element.sanitizer.Sanitizer.makeSaxParser">
        function <span class="apidocSignatureSpan">sanitizer.Sanitizer.</span>makeSaxParser
        <span class="apidocSignatureSpan">(handler)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function makeSaxParser(handler) {
    // Accept quoted or unquoted keys (Closure compat)
    var hcopy = {
        cdata: handler.cdata || handler[&#x27;cdata&#x27;],
        comment: handler.comment || handler[&#x27;comment&#x27;],
        endDoc: handler.endDoc || handler[&#x27;endDoc&#x27;],
        endTag: handler.endTag || handler[&#x27;endTag&#x27;],
        pcdata: handler.pcdata || handler[&#x27;pcdata&#x27;],
        rcdata: handler.rcdata || handler[&#x27;rcdata&#x27;],
        startDoc: handler.startDoc || handler[&#x27;startDoc&#x27;],
        startTag: handler.startTag || handler[&#x27;startTag&#x27;]
    };
    return function(htmlText, param) {
        return parse(htmlText, hcopy, param);
    };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
See /test/test-sanitzer.js for full documentation.

```
sanitizer.escape(&#x27;your dirty string&#x27;); // Escapes HTML special characters in attribute values as HTML entities
```

```
var yourParser = sanitizer.<span class="apidocCodeKeywordSpan">makeSaxParser</span>(yourHandler); // Given a SAX-like event handler
, produce a function that feeds those events and a parameter to the event handler.
```

```
sanitizer.normalizeRCData(&#x27;your dirty string&#x27;); // Escape entities in RCDATA that can be escaped without changing the
meaning.
```

```
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.Sanitizer.makeTagPolicy" id="apidoc.element.sanitizer.Sanitizer.makeTagPolicy">
        function <span class="apidocSignatureSpan">sanitizer.Sanitizer.</span>makeTagPolicy
        <span class="apidocSignatureSpan">( opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function makeTagPolicy( opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger) {
    return function(tagName, attribs) {
        if (!(html4.ELEMENTS[tagName] &#x26; html4.eflags[&#x27;UNSAFE&#x27;])) {
            return {
                &#x27;attribs&#x27;: sanitizeAttribs(tagName, attribs,
                    opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger)
            };
        } else {
            if (opt_logger) {
                log(opt_logger, tagName, undefined, undefined, undefined);
            }
        }
    };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.Sanitizer.normalizeRCData" id="apidoc.element.sanitizer.Sanitizer.normalizeRCData">
        function <span class="apidocSignatureSpan">sanitizer.Sanitizer.</span>normalizeRCData
        <span class="apidocSignatureSpan">(rcdata)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function normalizeRCData(rcdata) {
	if(rcdata) {
	    return rcdata
            .replace(looseAmpRe, &#x27;&#x26;amp;$1&#x27;)
            .replace(ltRe, &#x27;&#x26;lt;&#x27;)
            .replace(gtRe, &#x27;&#x26;gt;&#x27;);
	}
	else {
	    return rcdata;
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```

```
var yourParser = sanitizer.makeSaxParser(yourHandler); // Given a SAX-like event handler, produce a function that feeds those events
 and a parameter to the event handler.
```

```
sanitizer.<span class="apidocCodeKeywordSpan">normalizeRCData</span>(&#x27;your dirty string&#x27;); // Escape entities in RCDATA
 that can be escaped without changing the meaning.
```

```
sanitizer.sanitize(&#x27;your dirty string&#x27;); // Strips unsafe tags and attributes from html.
```

```
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.Sanitizer.sanitize" id="apidoc.element.sanitizer.Sanitizer.sanitize">
        function <span class="apidocSignatureSpan">sanitizer.Sanitizer.</span>sanitize
        <span class="apidocSignatureSpan">(inputHtml, opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sanitize = function (inputHtml, opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger) {
    if (typeof(inputHtml) === &#x22;string&#x22;) {
        inputHtml = inputHtml.replace(/&#x3c;([a-zA-Z]+)([^&#x3e;]*)\/&#x3e;/g, &#x27;&#x3c;$1$2&#x3e;&#x3c;/$1&#x3e;&#x27;);
    }

    if (inputHtml) {
        return html.sanitize(inputHtml, opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger);
    }
    else {
        return inputHtml;
    }

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```

```
sanitizer.normalizeRCData(&#x27;your dirty string&#x27;); // Escape entities in RCDATA that can be escaped without changing the
meaning.
```

```
sanitizer.<span class="apidocCodeKeywordSpan">sanitize</span>(&#x27;your dirty string&#x27;); // Strips unsafe tags and attributes
 from html.
```

```
exports.unescapeEntities(&#x27;your string&#x27;); // The plain text of a chunk of HTML CDATA which possibly containing.
```

## Caveats
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.Sanitizer.sanitizeAttribs" id="apidoc.element.sanitizer.Sanitizer.sanitizeAttribs">
        function <span class="apidocSignatureSpan">sanitizer.Sanitizer.</span>sanitizeAttribs
        <span class="apidocSignatureSpan">(tagName, attribs, opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function sanitizeAttribs(tagName, attribs, opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger) {
    // TODO(felix8a): it&#x27;s obnoxious that domado duplicates much of this
    // TODO(felix8a): maybe consistently enforce constraints like target=
    for (var i = 0; i &#x3c; attribs.length; i += 2) {
        var attribName = attribs[i];
        var value = attribs[i + 1];
        var oldValue = value;
        var atype = null, attribKey;
        if ((attribKey = tagName + &#x27;::&#x27; + attribName,
            html4.ATTRIBS.hasOwnProperty(attribKey)) ||
            (attribKey = &#x27;*::&#x27; + attribName,
                html4.ATTRIBS.hasOwnProperty(attribKey))) {
            atype = html4.ATTRIBS[attribKey];
        }
        if (atype !== null) {
            switch (atype) {
                case html4.atype[&#x27;NONE&#x27;]: break;
                case html4.atype[&#x27;SCRIPT&#x27;]:
                    value = null;
                    if (opt_logger) {
                        log(opt_logger, tagName, attribName, oldValue, value);
                    }
                    break;
                case html4.atype[&#x27;STYLE&#x27;]:
                    if (&#x27;undefined&#x27; === typeof parseCssDeclarations) {
                        value = null;
                        if (opt_logger) {
                            log(opt_logger, tagName, attribName, oldValue, value);
                        }
                        break;
                    }
                    var sanitizedDeclarations = [];
                    parseCssDeclarations(
                        value,
                        {
                            &#x27;declaration&#x27;: function (property, tokens) {
                                var normProp = property.toLowerCase();
                                sanitizeCssProperty(
                                    normProp, tokens,
                                    opt_naiveUriRewriter
                                        ? function (url) {
                                        return safeUri(
                                            url, html4.ueffects.SAME_DOCUMENT,
                                            html4.ltypes.SANDBOXED,
                                            {
                                                &#x22;TYPE&#x22;: &#x22;CSS&#x22;,
                                                &#x22;CSS_PROP&#x22;: normProp
                                            }, opt_naiveUriRewriter);
                                    }
                                        : null);
                                if (tokens.length) {
                                    sanitizedDeclarations.push(
                                        normProp + &#x27;: &#x27; + tokens.join(&#x27; &#x27;));
                                }
                            }
                        });
                    value = sanitizedDeclarations.length &#x3e; 0 ?
                        sanitizedDeclarations.join(&#x27; ; &#x27;) : null;
                    if (opt_logger) {
                        log(opt_logger, tagName, attribName, oldValue, value);
                    }
                    break;
                case html4.atype[&#x27;ID&#x27;]:
                case html4.atype[&#x27;IDREF&#x27;]:
                case html4.atype[&#x27;IDREFS&#x27;]:
                case html4.atype[&#x27;GLOBAL_NAME&#x27;]:
                case html4.atype[&#x27;LOCAL_NAME&#x27;]:
                case html4.atype[&#x27;CLASSES&#x27;]:
                    value = opt_nmTokenPolicy ? opt_nmTokenPolicy(value) : value;
                    if (opt_logger) {
                        log(opt_logger, tagName, attribName, oldValue, value);
                    }
                    break;
                case html4.atype[&#x27;URI&#x27;]:
                    value = safeUri(value,
                        getUriEffect(tagName, attribName),
                        getLoaderType(tagName, attribName),
                        {
                            &#x22;TYPE&#x22;: &#x22;MARKUP&#x22;,
                            &#x22;XML_ATTR&#x22;: attribName,
                            &#x22;XML_TAG&#x22;: tagName
                        }, opt_naiveUriRewriter);
                    if (opt_logger) {
                        log(opt_logger, tagName, attribName, o ...</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.Sanitizer.sanitizeWithPolicy" id="apidoc.element.sanitizer.Sanitizer.sanitizeWithPolicy">
        function <span class="apidocSignatureSpan">sanitizer.Sanitizer.</span>sanitizeWithPolicy
        <span class="apidocSignatureSpan">(inputHtml, tagPolicy)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function sanitizeWithPolicy(inputHtml, tagPolicy) {
    var outputArray = [];
    makeHtmlSanitizer(tagPolicy)(inputHtml, outputArray);
    return outputArray.join(&#x27;&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.Sanitizer.unescapeEntities" id="apidoc.element.sanitizer.Sanitizer.unescapeEntities">
        function <span class="apidocSignatureSpan">sanitizer.Sanitizer.</span>unescapeEntities
        <span class="apidocSignatureSpan">(s)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function unescapeEntities(s) {
	if(s) {
	    return s.replace(ENTITY_RE_1, decodeOneEntity);
	}
	else {
	    return s;
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```

```
sanitizer.sanitize(&#x27;your dirty string&#x27;); // Strips unsafe tags and attributes from html.
```

```
exports.<span class="apidocCodeKeywordSpan">unescapeEntities</span>(&#x27;your string&#x27;); // The plain text of a chunk of HTML
 CDATA which possibly containing.
```

## Caveats

It&#x27;s use this at your own risk really - Caja HTML Sanitizer was written by people far cleverer than me. I have just repackaged
 it to solve a problem I had (sanitization on a Node server). It seems to work, and it passes all its tests in re-packaged form -
however I don&#x27;t fully understand its internals so cannot guarantee its security.
...</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.sanitizer.uri" id="apidoc.module.sanitizer.uri">module sanitizer.uri</a></h1>


    <h2>
        <a href="#apidoc.element.sanitizer.uri.uri" id="apidoc.element.sanitizer.uri.uri">
        function <span class="apidocSignatureSpan">sanitizer.</span>uri
        <span class="apidocSignatureSpan">( rawScheme, rawCredentials, rawDomain, port, rawPath, rawQuery, rawFragment)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function URI( rawScheme, rawCredentials, rawDomain, port, rawPath, rawQuery, rawFragment) {
    this.scheme_ = rawScheme;
    this.credentials_ = rawCredentials;
    this.domain_ = rawDomain;
    this.port_ = port;
    this.path_ = rawPath;
    this.query_ = rawQuery;
    this.fragment_ = rawFragment;
<span class="apidocCodeCommentSpan">    /**
     * @type {Array|null}
     */
</span>    this.paramCache_ = null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.URI" id="apidoc.element.sanitizer.uri.URI">
        function <span class="apidocSignatureSpan">sanitizer.uri.</span>URI
        <span class="apidocSignatureSpan">( rawScheme, rawCredentials, rawDomain, port, rawPath, rawQuery, rawFragment)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function URI( rawScheme, rawCredentials, rawDomain, port, rawPath, rawQuery, rawFragment) {
    this.scheme_ = rawScheme;
    this.credentials_ = rawCredentials;
    this.domain_ = rawDomain;
    this.port_ = port;
    this.path_ = rawPath;
    this.query_ = rawQuery;
    this.fragment_ = rawFragment;
<span class="apidocCodeCommentSpan">    /**
     * @type {Array|null}
     */
</span>    this.paramCache_ = null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.collapse_dots" id="apidoc.element.sanitizer.uri.collapse_dots">
        function <span class="apidocSignatureSpan">sanitizer.uri.</span>collapse_dots
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function collapse_dots(path) {
    if (path === null) { return null; }
    var p = normPath(path);
    // Only /../ left to flatten
    var r = PARENT_DIRECTORY_HANDLER_RE;
    // We replace with $1 which matches a / before the .. because this
    // guarantees that:
    // (1) we have at most 1 / between the adjacent place,
    // (2) always have a slash if there is a preceding path section, and
    // (3) we never turn a relative path into an absolute path.
    for (var q; (q = p.replace(r, &#x27;$1&#x27;)) != p; p = q) {};
    return p;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.create" id="apidoc.element.sanitizer.uri.create">
        function <span class="apidocSignatureSpan">sanitizer.uri.</span>create
        <span class="apidocSignatureSpan">(scheme, credentials, domain, port, path, query, fragment)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function create(scheme, credentials, domain, port, path, query, fragment) {
    var uri = new URI(
        encodeIfExists2(scheme, URI_DISALLOWED_IN_SCHEME_OR_CREDENTIALS_),
        encodeIfExists2(
            credentials, URI_DISALLOWED_IN_SCHEME_OR_CREDENTIALS_),
        encodeIfExists(domain),
        port &#x3e; 0 ? port.toString() : null,
        encodeIfExists2(path, URI_DISALLOWED_IN_PATH_),
        null,
        encodeIfExists(fragment));
    if (query) {
        if (&#x27;string&#x27; === typeof query) {
            uri.setRawQuery(query.replace(/[^?&#x26;=0-9A-Za-z_\-~.%]/g, encodeOne));
        } else {
            uri.setAllParameters(query);
        }
    }
    return uri;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.parse" id="apidoc.element.sanitizer.uri.parse">
        function <span class="apidocSignatureSpan">sanitizer.uri.</span>parse
        <span class="apidocSignatureSpan">(uriStr)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function parse(uriStr) {
    var m = (&#x27;&#x27; + uriStr).match(URI_RE_);
    if (!m) { return null; }
    return new URI(
        nullIfAbsent(m[1]),
        nullIfAbsent(m[2]),
        nullIfAbsent(m[3]),
        nullIfAbsent(m[4]),
        nullIfAbsent(m[5]),
        nullIfAbsent(m[6]),
        nullIfAbsent(m[7]));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

/**
 * a mutable URI.
 *
 * This class contains setters and getters for the parts of the URI.
 * The &#x3c;tt&#x3e;getXYZ&#x3c;/tt&#x3e;/&#x3c;tt&#x3e;setXYZ&#x3c;/tt&#x3e; methods return the decoded part -- so
 * &#x3c;code&#x3e;uri.<span class="apidocCodeKeywordSpan">parse</span>(&#x27;/foo%20bar&#x27;).getPath()&#x3c;/code&#x3e; will
return the decoded path,
 * &#x3c;tt&#x3e;/foo bar&#x3c;/tt&#x3e;.
 *
 * &#x3c;p&#x3e;The raw versions of fields are available too.
 * &#x3c;code&#x3e;uri.parse(&#x27;/foo%20bar&#x27;).getRawPath()&#x3c;/code&#x3e; will return the raw path,
 * &#x3c;tt&#x3e;/foo%20bar&#x3c;/tt&#x3e;.  Use the raw setters with care, since
 * &#x3c;code&#x3e;URI::toString&#x3c;/code&#x3e; is not guaranteed to return a valid url if a
 * raw setter was used.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.resolve" id="apidoc.element.sanitizer.uri.resolve">
        function <span class="apidocSignatureSpan">sanitizer.uri.</span>resolve
        <span class="apidocSignatureSpan">(baseUri, relativeUri)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function resolve(baseUri, relativeUri) {
    // there are several kinds of relative urls:
    // 1. //foo - replaces everything from the domain on.  foo is a domain name
    // 2. foo - replaces the last part of the path, the whole query and fragment
    // 3. /foo - replaces the the path, the query and fragment
    // 4. ?foo - replace the query and fragment
    // 5. #foo - replace the fragment only

    var absoluteUri = baseUri.clone();
    // we satisfy these conditions by looking for the first part of relativeUri
    // that is not blank and applying defaults to the rest

    var overridden = relativeUri.hasScheme();

    if (overridden) {
        absoluteUri.setRawScheme(relativeUri.getRawScheme());
    } else {
        overridden = relativeUri.hasCredentials();
    }

    if (overridden) {
        absoluteUri.setRawCredentials(relativeUri.getRawCredentials());
    } else {
        overridden = relativeUri.hasDomain();
    }

    if (overridden) {
        absoluteUri.setRawDomain(relativeUri.getRawDomain());
    } else {
        overridden = relativeUri.hasPort();
    }

    var rawPath = relativeUri.getRawPath();
    var simplifiedPath = collapse_dots(rawPath);
    if (overridden) {
        absoluteUri.setPort(relativeUri.getPort());
        simplifiedPath = simplifiedPath
            &#x26;&#x26; simplifiedPath.replace(EXTRA_PARENT_PATHS_RE, &#x27;&#x27;);
    } else {
        overridden = !!rawPath;
        if (overridden) {
            // resolve path properly
            if (simplifiedPath.charCodeAt(0) !== 0x2f /* / */) {  // path is relative
                var absRawPath = collapse_dots(absoluteUri.getRawPath() || &#x27;&#x27;)
                    .replace(EXTRA_PARENT_PATHS_RE, &#x27;&#x27;);
                var slash = absRawPath.lastIndexOf(&#x27;/&#x27;) + 1;
                simplifiedPath = collapse_dots(
                    (slash ? absRawPath.substring(0, slash) : &#x27;&#x27;)
                        + collapse_dots(rawPath))
                    .replace(EXTRA_PARENT_PATHS_RE, &#x27;&#x27;);
            }
        } else {
            simplifiedPath = simplifiedPath
                &#x26;&#x26; simplifiedPath.replace(EXTRA_PARENT_PATHS_RE, &#x27;&#x27;);
            if (simplifiedPath !== rawPath) {
                absoluteUri.setRawPath(simplifiedPath);
            }
        }
    }

    if (overridden) {
        absoluteUri.setRawPath(simplifiedPath);
    } else {
        overridden = relativeUri.hasQuery();
    }

    if (overridden) {
        absoluteUri.setRawQuery(relativeUri.getRawQuery());
    } else {
        overridden = relativeUri.hasFragment();
    }

    if (overridden) {
        absoluteUri.setRawFragment(relativeUri.getRawFragment());
    }

    return absoluteUri;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.sanitizer.uri.prototype" id="apidoc.module.sanitizer.uri.prototype">module sanitizer.uri.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.checkParameterCache_" id="apidoc.element.sanitizer.uri.prototype.checkParameterCache_">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>checkParameterCache_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">checkParameterCache_ = function () {
    if (!this.paramCache_) {
        var q = this.query_;
        if (!q) {
            this.paramCache_ = [];
        } else {
            var cgiParams = q.split(/[&#x26;\?]/);
            var out = [];
            var k = -1;
            for (var i = 0; i &#x3c; cgiParams.length; ++i) {
                var m = cgiParams[i].match(/^([^=]*)(?:=(.*))?$/);
                // From http://www.w3.org/Addressing/URL/4_URI_Recommentations.html
                // Within the query string, the plus sign is reserved as shorthand
                // notation for a space.
                out[++k] = decodeURIComponent(m[1]).replace(/\+/g, &#x27; &#x27;);
                out[++k] = decodeURIComponent(m[2] || &#x27;&#x27;).replace(/\+/g, &#x27; &#x27;);
            }
            this.paramCache_ = out;
        }
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    URI.prototype.setParameterValues = function (key, values) {
// be nice and avoid subtle bugs where [] operator on string performs charAt
// on some browsers and crashes on IE
if (typeof values === &#x27;string&#x27;) {
    values = [ values ];
}

this.<span class="apidocCodeKeywordSpan">checkParameterCache_</span>();
var newValueIndex = 0;
var pc = this.paramCache_;
var params = [];
for (var i = 0, k = 0; i &#x3c; pc.length; i += 2) {
    if (key === pc[i]) {
        if (newValueIndex &#x3c; values.length) {
            params.push(key, values[newValueIndex++]);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.clone" id="apidoc.element.sanitizer.uri.prototype.clone">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>clone
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">clone = function () {
    return new URI(this.scheme_, this.credentials_, this.domain_, this.port_,
        this.path_, this.query_, this.fragment_);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// there are several kinds of relative urls:
// 1. //foo - replaces everything from the domain on.  foo is a domain name
// 2. foo - replaces the last part of the path, the whole query and fragment
// 3. /foo - replaces the the path, the query and fragment
// 4. ?foo - replace the query and fragment
// 5. #foo - replace the fragment only

var absoluteUri = baseUri.<span class="apidocCodeKeywordSpan">clone</span>();
// we satisfy these conditions by looking for the first part of relativeUri
// that is not blank and applying defaults to the rest

var overridden = relativeUri.hasScheme();

if (overridden) {
    absoluteUri.setRawScheme(relativeUri.getRawScheme());
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.getAllParameters" id="apidoc.element.sanitizer.uri.prototype.getAllParameters">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>getAllParameters
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getAllParameters = function () {
    this.checkParameterCache_();
    return this.paramCache_.slice(0, this.paramCache_.length);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.getCredentials" id="apidoc.element.sanitizer.uri.prototype.getCredentials">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>getCredentials
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getCredentials = function () {
    return this.credentials_ &#x26;&#x26; decodeURIComponent(this.credentials_);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.getDomain" id="apidoc.element.sanitizer.uri.prototype.getDomain">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>getDomain
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getDomain = function () {
    return this.domain_ &#x26;&#x26; decodeURIComponent(this.domain_);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.getFragment" id="apidoc.element.sanitizer.uri.prototype.getFragment">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>getFragment
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getFragment = function () {
    return this.fragment_ &#x26;&#x26; decodeURIComponent(this.fragment_);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.getParameterMap" id="apidoc.element.sanitizer.uri.prototype.getParameterMap">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>getParameterMap
        <span class="apidocSignatureSpan">(paramNameUnescaped)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getParameterMap = function (paramNameUnescaped) {
    this.checkParameterCache_();
    var paramMap = {};
    for (var i = 0; i &#x3c; this.paramCache_.length; i += 2) {
        var key = this.paramCache_[i++],
            value = this.paramCache_[i++];
        if (!(key in paramMap)) {
            paramMap[key] = [value];
        } else {
            paramMap[key].push(value);
        }
    }
    return paramMap;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.getParameterValue" id="apidoc.element.sanitizer.uri.prototype.getParameterValue">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>getParameterValue
        <span class="apidocSignatureSpan">(paramNameUnescaped)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getParameterValue = function (paramNameUnescaped) {
    this.checkParameterCache_();
    for (var i = 0; i &#x3c; this.paramCache_.length; i += 2) {
        if (paramNameUnescaped === this.paramCache_[i]) {
            return this.paramCache_[i + 1];
        }
    }
    return null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.getParameterValues" id="apidoc.element.sanitizer.uri.prototype.getParameterValues">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>getParameterValues
        <span class="apidocSignatureSpan">(paramNameUnescaped)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getParameterValues = function (paramNameUnescaped) {
    this.checkParameterCache_();
    var values = [];
    for (var i = 0; i &#x3c; this.paramCache_.length; i += 2) {
        if (paramNameUnescaped === this.paramCache_[i]) {
            values.push(this.paramCache_[i + 1]);
        }
    }
    return values;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.getPath" id="apidoc.element.sanitizer.uri.prototype.getPath">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>getPath
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getPath = function () {
    return this.path_ &#x26;&#x26; decodeURIComponent(this.path_);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

/**
 * a mutable URI.
 *
 * This class contains setters and getters for the parts of the URI.
 * The &#x3c;tt&#x3e;getXYZ&#x3c;/tt&#x3e;/&#x3c;tt&#x3e;setXYZ&#x3c;/tt&#x3e; methods return the decoded part -- so
 * &#x3c;code&#x3e;uri.parse(&#x27;/foo%20bar&#x27;).<span class="apidocCodeKeywordSpan">getPath</span>()&#x3c;/code&#x3e; will
return the decoded path,
 * &#x3c;tt&#x3e;/foo bar&#x3c;/tt&#x3e;.
 *
 * &#x3c;p&#x3e;The raw versions of fields are available too.
 * &#x3c;code&#x3e;uri.parse(&#x27;/foo%20bar&#x27;).getRawPath()&#x3c;/code&#x3e; will return the raw path,
 * &#x3c;tt&#x3e;/foo%20bar&#x3c;/tt&#x3e;.  Use the raw setters with care, since
 * &#x3c;code&#x3e;URI::toString&#x3c;/code&#x3e; is not guaranteed to return a valid url if a
 * raw setter was used.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.getPort" id="apidoc.element.sanitizer.uri.prototype.getPort">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>getPort
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getPort = function () {
    return this.port_ &#x26;&#x26; decodeURIComponent(this.port_);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
} else {
    overridden = relativeUri.hasPort();
}

var rawPath = relativeUri.getRawPath();
var simplifiedPath = collapse_dots(rawPath);
if (overridden) {
    absoluteUri.setPort(relativeUri.<span class="apidocCodeKeywordSpan">getPort</span>());
    simplifiedPath = simplifiedPath
        &#x26;&#x26; simplifiedPath.replace(EXTRA_PARENT_PATHS_RE, &#x27;&#x27;);
} else {
    overridden = !!rawPath;
    if (overridden) {
        // resolve path properly
        if (simplifiedPath.charCodeAt(0) !== 0x2f /* / */) {  // path is relative
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.getQuery" id="apidoc.element.sanitizer.uri.prototype.getQuery">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>getQuery
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getQuery = function () {
    // From http://www.w3.org/Addressing/URL/4_URI_Recommentations.html
    // Within the query string, the plus sign is reserved as shorthand notation
    // for a space.
    return this.query_ &#x26;&#x26; decodeURIComponent(this.query_).replace(/\+/g, &#x27; &#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    return null !== this.query_;
};

/**
 * sets the query given a list of strings of the form
 * [ key0, value0, key1, value1, ... ].
 *
 * &#x3c;p&#x3e;&#x3c;code&#x3e;uri.setAllParameters([&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;, &#x27;d&#x27;]).<span class="
apidocCodeKeywordSpan">getQuery</span>()&#x3c;/code&#x3e;
 * will yield &#x3c;code&#x3e;&#x27;a=b&#x26;c=d&#x27;&#x3c;/code&#x3e;.
 */
URI.prototype.setAllParameters = function (params) {
    if (typeof params === &#x27;object&#x27;) {
        if (!(params instanceof Array)
            &#x26;&#x26; (params instanceof Object
            || Object.prototype.toString.call(params) !== &#x27;[object Array]&#x27;)) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.getRawCredentials" id="apidoc.element.sanitizer.uri.prototype.getRawCredentials">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>getRawCredentials
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getRawCredentials = function () {
    return this.credentials_;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if (overridden) {
    absoluteUri.setRawScheme(relativeUri.getRawScheme());
} else {
    overridden = relativeUri.hasCredentials();
}

if (overridden) {
    absoluteUri.setRawCredentials(relativeUri.<span class="apidocCodeKeywordSpan">getRawCredentials</span>());
} else {
    overridden = relativeUri.hasDomain();
}

if (overridden) {
    absoluteUri.setRawDomain(relativeUri.getRawDomain());
} else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.getRawDomain" id="apidoc.element.sanitizer.uri.prototype.getRawDomain">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>getRawDomain
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getRawDomain = function () {
    return this.domain_;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if (overridden) {
    absoluteUri.setRawCredentials(relativeUri.getRawCredentials());
} else {
    overridden = relativeUri.hasDomain();
}

if (overridden) {
    absoluteUri.setRawDomain(relativeUri.<span class="apidocCodeKeywordSpan">getRawDomain</span>());
} else {
    overridden = relativeUri.hasPort();
}

var rawPath = relativeUri.getRawPath();
var simplifiedPath = collapse_dots(rawPath);
if (overridden) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.getRawFragment" id="apidoc.element.sanitizer.uri.prototype.getRawFragment">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>getRawFragment
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getRawFragment = function () {
    return this.fragment_;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    if (overridden) {
        absoluteUri.setRawQuery(relativeUri.getRawQuery());
    } else {
        overridden = relativeUri.hasFragment();
    }

    if (overridden) {
        absoluteUri.setRawFragment(relativeUri.<span class="apidocCodeKeywordSpan">getRawFragment</span>());
    }

    return absoluteUri;
}

/**
 * a mutable URI.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.getRawPath" id="apidoc.element.sanitizer.uri.prototype.getRawPath">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>getRawPath
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getRawPath = function () {
    return this.path_;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

if (overridden) {
    absoluteUri.setRawDomain(relativeUri.getRawDomain());
} else {
    overridden = relativeUri.hasPort();
}

var rawPath = relativeUri.<span class="apidocCodeKeywordSpan">getRawPath</span>();
var simplifiedPath = collapse_dots(rawPath);
if (overridden) {
    absoluteUri.setPort(relativeUri.getPort());
    simplifiedPath = simplifiedPath
        &#x26;&#x26; simplifiedPath.replace(EXTRA_PARENT_PATHS_RE, &#x27;&#x27;);
} else {
    overridden = !!rawPath;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.getRawQuery" id="apidoc.element.sanitizer.uri.prototype.getRawQuery">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>getRawQuery
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getRawQuery = function () {
    return this.query_;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if (overridden) {
    absoluteUri.setRawPath(simplifiedPath);
} else {
    overridden = relativeUri.hasQuery();
}

if (overridden) {
    absoluteUri.setRawQuery(relativeUri.<span class="apidocCodeKeywordSpan">getRawQuery</span>());
} else {
    overridden = relativeUri.hasFragment();
}

if (overridden) {
    absoluteUri.setRawFragment(relativeUri.getRawFragment());
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.getRawScheme" id="apidoc.element.sanitizer.uri.prototype.getRawScheme">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>getRawScheme
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getRawScheme = function () {
    return this.scheme_;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var absoluteUri = baseUri.clone();
// we satisfy these conditions by looking for the first part of relativeUri
// that is not blank and applying defaults to the rest

var overridden = relativeUri.hasScheme();

if (overridden) {
    absoluteUri.setRawScheme(relativeUri.<span class="apidocCodeKeywordSpan">getRawScheme</span>());
} else {
    overridden = relativeUri.hasCredentials();
}

if (overridden) {
    absoluteUri.setRawCredentials(relativeUri.getRawCredentials());
} else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.getScheme" id="apidoc.element.sanitizer.uri.prototype.getScheme">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>getScheme
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getScheme = function () {
    // HTML5 spec does not require the scheme to be lowercased but
    // all common browsers except Safari lowercase the scheme.
    return this.scheme_ &#x26;&#x26; decodeURIComponent(this.scheme_).toLowerCase();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.hasCredentials" id="apidoc.element.sanitizer.uri.prototype.hasCredentials">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>hasCredentials
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">hasCredentials = function () {
    return null !== this.credentials_;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// that is not blank and applying defaults to the rest

var overridden = relativeUri.hasScheme();

if (overridden) {
    absoluteUri.setRawScheme(relativeUri.getRawScheme());
} else {
    overridden = relativeUri.<span class="apidocCodeKeywordSpan">hasCredentials</span>();
}

if (overridden) {
    absoluteUri.setRawCredentials(relativeUri.getRawCredentials());
} else {
    overridden = relativeUri.hasDomain();
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.hasDomain" id="apidoc.element.sanitizer.uri.prototype.hasDomain">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>hasDomain
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">hasDomain = function () {
    return null !== this.domain_;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
} else {
    overridden = relativeUri.hasCredentials();
}

if (overridden) {
    absoluteUri.setRawCredentials(relativeUri.getRawCredentials());
} else {
    overridden = relativeUri.<span class="apidocCodeKeywordSpan">hasDomain</span>();
}

if (overridden) {
    absoluteUri.setRawDomain(relativeUri.getRawDomain());
} else {
    overridden = relativeUri.hasPort();
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.hasFragment" id="apidoc.element.sanitizer.uri.prototype.hasFragment">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>hasFragment
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">hasFragment = function () {
    return null !== this.fragment_;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
} else {
    overridden = relativeUri.hasQuery();
}

if (overridden) {
    absoluteUri.setRawQuery(relativeUri.getRawQuery());
} else {
    overridden = relativeUri.<span class="apidocCodeKeywordSpan">hasFragment</span>();
}

if (overridden) {
    absoluteUri.setRawFragment(relativeUri.getRawFragment());
}

return absoluteUri;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.hasPath" id="apidoc.element.sanitizer.uri.prototype.hasPath">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>hasPath
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">hasPath = function () {
    return null !== this.path_;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.hasPort" id="apidoc.element.sanitizer.uri.prototype.hasPort">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>hasPort
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">hasPort = function () {
    return null !== this.port_;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
} else {
    overridden = relativeUri.hasDomain();
}

if (overridden) {
    absoluteUri.setRawDomain(relativeUri.getRawDomain());
} else {
    overridden = relativeUri.<span class="apidocCodeKeywordSpan">hasPort</span>();
}

var rawPath = relativeUri.getRawPath();
var simplifiedPath = collapse_dots(rawPath);
if (overridden) {
    absoluteUri.setPort(relativeUri.getPort());
    simplifiedPath = simplifiedPath
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.hasQuery" id="apidoc.element.sanitizer.uri.prototype.hasQuery">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>hasQuery
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">hasQuery = function () {
    return null !== this.query_;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        }
    }
}

if (overridden) {
    absoluteUri.setRawPath(simplifiedPath);
} else {
    overridden = relativeUri.<span class="apidocCodeKeywordSpan">hasQuery</span>();
}

if (overridden) {
    absoluteUri.setRawQuery(relativeUri.getRawQuery());
} else {
    overridden = relativeUri.hasFragment();
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.hasScheme" id="apidoc.element.sanitizer.uri.prototype.hasScheme">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>hasScheme
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">hasScheme = function () {
    return null !== this.scheme_;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// 4. ?foo - replace the query and fragment
// 5. #foo - replace the fragment only

var absoluteUri = baseUri.clone();
// we satisfy these conditions by looking for the first part of relativeUri
// that is not blank and applying defaults to the rest

var overridden = relativeUri.<span class="apidocCodeKeywordSpan">hasScheme</span>();

if (overridden) {
    absoluteUri.setRawScheme(relativeUri.getRawScheme());
} else {
    overridden = relativeUri.hasCredentials();
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.removeParameter" id="apidoc.element.sanitizer.uri.prototype.removeParameter">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>removeParameter
        <span class="apidocSignatureSpan">(key)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">removeParameter = function (key) {
    return this.setParameterValues(key, []);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.setAllParameters" id="apidoc.element.sanitizer.uri.prototype.setAllParameters">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>setAllParameters
        <span class="apidocSignatureSpan">(params)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setAllParameters = function (params) {
    if (typeof params === &#x27;object&#x27;) {
        if (!(params instanceof Array)
            &#x26;&#x26; (params instanceof Object
            || Object.prototype.toString.call(params) !== &#x27;[object Array]&#x27;)) {
            var newParams = [];
            var i = -1;
            for (var k in params) {
                var v = params[k];
                if (&#x27;string&#x27; === typeof v) {
                    newParams[++i] = k;
                    newParams[++i] = v;
                }
            }
            params = newParams;
        }
    }
    this.paramCache_ = null;
    var queryBuf = [];
    var separator = &#x27;&#x27;;
    for (var j = 0; j &#x3c; params.length;) {
        var k = params[j++];
        var v = params[j++];
        queryBuf.push(separator, encodeURIComponent(k.toString()));
        separator = &#x27;&#x26;&#x27;;
        if (v) {
            queryBuf.push(&#x27;=&#x27;, encodeURIComponent(v.toString()));
        }
    }
    this.query_ = queryBuf.join(&#x27;&#x27;);
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        encodeIfExists2(path, URI_DISALLOWED_IN_PATH_),
        null,
        encodeIfExists(fragment));
    if (query) {
        if (&#x27;string&#x27; === typeof query) {
            uri.setRawQuery(query.replace(/[^?&#x26;=0-9A-Za-z_\-~.%]/g, encodeOne));
        } else {
            uri.<span class="apidocCodeKeywordSpan">setAllParameters</span>(query);
        }
    }
    return uri;
}
function encodeIfExists(unescapedPart) {
    if (&#x27;string&#x27; == typeof unescapedPart) {
        return encodeURIComponent(unescapedPart);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.setCredentials" id="apidoc.element.sanitizer.uri.prototype.setCredentials">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>setCredentials
        <span class="apidocSignatureSpan">(newCredentials)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setCredentials = function (newCredentials) {
    this.credentials_ = encodeIfExists2(
        newCredentials, URI_DISALLOWED_IN_SCHEME_OR_CREDENTIALS_);

    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.setDomain" id="apidoc.element.sanitizer.uri.prototype.setDomain">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>setDomain
        <span class="apidocSignatureSpan">(newDomain)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setDomain = function (newDomain) {
    return this.setRawDomain(newDomain &#x26;&#x26; encodeURIComponent(newDomain));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.setFragment" id="apidoc.element.sanitizer.uri.prototype.setFragment">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>setFragment
        <span class="apidocSignatureSpan">(newFragment)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setFragment = function (newFragment) {
    this.fragment_ = newFragment ? encodeURIComponent(newFragment) : null;
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* &#x3c;p&#x3e;The raw versions of fields are available too.
* &#x3c;code&#x3e;uri.parse(&#x27;/foo%20bar&#x27;).getRawPath()&#x3c;/code&#x3e; will return the raw path,
* &#x3c;tt&#x3e;/foo%20bar&#x3c;/tt&#x3e;.  Use the raw setters with care, since
* &#x3c;code&#x3e;URI::toString&#x3c;/code&#x3e; is not guaranteed to return a valid url if a
* raw setter was used.
*
* &#x3c;p&#x3e;All setters return &#x3c;tt&#x3e;this&#x3c;/tt&#x3e; and so may be chained, a la
* &#x3c;code&#x3e;uri.parse(&#x27;/foo&#x27;).<span class="apidocCodeKeywordSpan">setFragment</span>(&#x27;part&#x27;).toString()&#
x3c;/code&#x3e;.
*
* &#x3c;p&#x3e;You should not use this constructor directly -- please prefer the factory
* functions {@link uri.parse}, {@link uri.create}, {@link uri.resolve}
* instead.&#x3c;/p&#x3e;
*
* &#x3c;p&#x3e;The parameters are all raw (assumed to be properly escaped) parts, and
* any (but not all) may be null.  Undefined is not allowed.&#x3c;/p&#x3e;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.setParameterValues" id="apidoc.element.sanitizer.uri.prototype.setParameterValues">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>setParameterValues
        <span class="apidocSignatureSpan">(key, values)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setParameterValues = function (key, values) {
    // be nice and avoid subtle bugs where [] operator on string performs charAt
    // on some browsers and crashes on IE
    if (typeof values === &#x27;string&#x27;) {
        values = [ values ];
    }

    this.checkParameterCache_();
    var newValueIndex = 0;
    var pc = this.paramCache_;
    var params = [];
    for (var i = 0, k = 0; i &#x3c; pc.length; i += 2) {
        if (key === pc[i]) {
            if (newValueIndex &#x3c; values.length) {
                params.push(key, values[newValueIndex++]);
            }
        } else {
            params.push(pc[i], pc[i + 1]);
        }
    }
    while (newValueIndex &#x3c; values.length) {
        params.push(key, values[newValueIndex++]);
    }
    this.setAllParameters(params);
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
            this.paramCache_ = out;
        }
    }
};
/**
 * sets the values of the named cgi parameters.
 *
 * &#x3c;p&#x3e;So, &#x3c;code&#x3e;uri.parse(&#x27;foo?a=b&#x26;c=d&#x26;e=f&#x27;).<span class="apidocCodeKeywordSpan">setParameterValues
</span>(&#x27;c&#x27;, [&#x27;new&#x27;])
 * &#x3c;/code&#x3e; yields &#x3c;tt&#x3e;foo?a=b&#x26;c=new&#x26;e=f&#x3c;/tt&#x3e;.&#x3c;/p&#x3e;
 *
 * @param key {string}
 * @param values {Array.&#x3c;string&#x3e;} the new values.  If values is a single string
 *   then it will be treated as the sole value.
 */
URI.prototype.setParameterValues = function (key, values) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.setPath" id="apidoc.element.sanitizer.uri.prototype.setPath">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>setPath
        <span class="apidocSignatureSpan">(newPath)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setPath = function (newPath) {
    return this.setRawPath(encodeIfExists2(newPath, URI_DISALLOWED_IN_PATH_));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.setPort" id="apidoc.element.sanitizer.uri.prototype.setPort">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>setPort
        <span class="apidocSignatureSpan">(newPort)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setPort = function (newPort) {
    if (newPort) {
        newPort = Number(newPort);
        if (newPort !== (newPort &#x26; 0xffff)) {
            throw new Error(&#x27;Bad port number &#x27; + newPort);
        }
        this.port_ = &#x27;&#x27; + newPort;
    } else {
        this.port_ = null;
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
} else {
    overridden = relativeUri.hasPort();
}

var rawPath = relativeUri.getRawPath();
var simplifiedPath = collapse_dots(rawPath);
if (overridden) {
    absoluteUri.<span class="apidocCodeKeywordSpan">setPort</span>(relativeUri.getPort());
    simplifiedPath = simplifiedPath
        &#x26;&#x26; simplifiedPath.replace(EXTRA_PARENT_PATHS_RE, &#x27;&#x27;);
} else {
    overridden = !!rawPath;
    if (overridden) {
        // resolve path properly
        if (simplifiedPath.charCodeAt(0) !== 0x2f /* / */) {  // path is relative
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.setQuery" id="apidoc.element.sanitizer.uri.prototype.setQuery">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>setQuery
        <span class="apidocSignatureSpan">(newQuery)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setQuery = function (newQuery) {
    this.paramCache_ = null;
    this.query_ = encodeIfExists(newQuery);
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.setRawCredentials" id="apidoc.element.sanitizer.uri.prototype.setRawCredentials">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>setRawCredentials
        <span class="apidocSignatureSpan">(newCredentials)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setRawCredentials = function (newCredentials) {
    this.credentials_ = newCredentials ? newCredentials : null;
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if (overridden) {
    absoluteUri.setRawScheme(relativeUri.getRawScheme());
} else {
    overridden = relativeUri.hasCredentials();
}

if (overridden) {
    absoluteUri.<span class="apidocCodeKeywordSpan">setRawCredentials</span>(relativeUri.getRawCredentials());
} else {
    overridden = relativeUri.hasDomain();
}

if (overridden) {
    absoluteUri.setRawDomain(relativeUri.getRawDomain());
} else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.setRawDomain" id="apidoc.element.sanitizer.uri.prototype.setRawDomain">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>setRawDomain
        <span class="apidocSignatureSpan">(newDomain)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setRawDomain = function (newDomain) {
    this.domain_ = newDomain ? newDomain : null;
    // Maintain the invariant that paths must start with a slash when the URI
    // is not path-relative.
    return this.setRawPath(this.path_);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if (overridden) {
    absoluteUri.setRawCredentials(relativeUri.getRawCredentials());
} else {
    overridden = relativeUri.hasDomain();
}

if (overridden) {
    absoluteUri.<span class="apidocCodeKeywordSpan">setRawDomain</span>(relativeUri.getRawDomain());
} else {
    overridden = relativeUri.hasPort();
}

var rawPath = relativeUri.getRawPath();
var simplifiedPath = collapse_dots(rawPath);
if (overridden) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.setRawFragment" id="apidoc.element.sanitizer.uri.prototype.setRawFragment">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>setRawFragment
        <span class="apidocSignatureSpan">(newFragment)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setRawFragment = function (newFragment) {
    this.fragment_ = newFragment ? newFragment : null;
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    if (overridden) {
        absoluteUri.setRawQuery(relativeUri.getRawQuery());
    } else {
        overridden = relativeUri.hasFragment();
    }

    if (overridden) {
        absoluteUri.<span class="apidocCodeKeywordSpan">setRawFragment</span>(relativeUri.getRawFragment());
    }

    return absoluteUri;
}

/**
 * a mutable URI.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.setRawPath" id="apidoc.element.sanitizer.uri.prototype.setRawPath">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>setRawPath
        <span class="apidocSignatureSpan">(newPath)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setRawPath = function (newPath) {
    if (newPath) {
        newPath = String(newPath);
        this.path_ =
            // Paths must start with &#x27;/&#x27; unless this is a path-relative URL.
            (!this.domain_ || /^\//.test(newPath)) ? newPath : &#x27;/&#x27; + newPath;
    } else {
        this.path_ = null;
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
                    + collapse_dots(rawPath))
                .replace(EXTRA_PARENT_PATHS_RE, &#x27;&#x27;);
        }
    } else {
        simplifiedPath = simplifiedPath
            &#x26;&#x26; simplifiedPath.replace(EXTRA_PARENT_PATHS_RE, &#x27;&#x27;);
        if (simplifiedPath !== rawPath) {
            absoluteUri.<span class="apidocCodeKeywordSpan">setRawPath</span>(simplifiedPath);
        }
    }
}

if (overridden) {
    absoluteUri.setRawPath(simplifiedPath);
} else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.setRawQuery" id="apidoc.element.sanitizer.uri.prototype.setRawQuery">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>setRawQuery
        <span class="apidocSignatureSpan">(newQuery)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setRawQuery = function (newQuery) {
    this.paramCache_ = null;
    this.query_ = newQuery ? newQuery : null;
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        encodeIfExists(domain),
        port &#x3e; 0 ? port.toString() : null,
        encodeIfExists2(path, URI_DISALLOWED_IN_PATH_),
        null,
        encodeIfExists(fragment));
    if (query) {
        if (&#x27;string&#x27; === typeof query) {
            uri.<span class="apidocCodeKeywordSpan">setRawQuery</span>(query.replace(/[^?&#x26;=0-9A-Za-z_\-~.%]/g, encodeOne));
        } else {
            uri.setAllParameters(query);
        }
    }
    return uri;
}
function encodeIfExists(unescapedPart) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.setRawScheme" id="apidoc.element.sanitizer.uri.prototype.setRawScheme">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>setRawScheme
        <span class="apidocSignatureSpan">(newScheme)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setRawScheme = function (newScheme) {
    this.scheme_ = newScheme ? newScheme : null;
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var absoluteUri = baseUri.clone();
// we satisfy these conditions by looking for the first part of relativeUri
// that is not blank and applying defaults to the rest

var overridden = relativeUri.hasScheme();

if (overridden) {
    absoluteUri.<span class="apidocCodeKeywordSpan">setRawScheme</span>(relativeUri.getRawScheme());
} else {
    overridden = relativeUri.hasCredentials();
}

if (overridden) {
    absoluteUri.setRawCredentials(relativeUri.getRawCredentials());
} else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.setScheme" id="apidoc.element.sanitizer.uri.prototype.setScheme">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>setScheme
        <span class="apidocSignatureSpan">(newScheme)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setScheme = function (newScheme) {
    this.scheme_ = encodeIfExists2(
        newScheme, URI_DISALLOWED_IN_SCHEME_OR_CREDENTIALS_);
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sanitizer.uri.prototype.toString" id="apidoc.element.sanitizer.uri.prototype.toString">
        function <span class="apidocSignatureSpan">sanitizer.uri.prototype.</span>toString
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toString = function () {
    var out = [];
    if (null !== this.scheme_) { out.push(this.scheme_, &#x27;:&#x27;); }
    if (null !== this.domain_) {
        out.push(&#x27;//&#x27;);
        if (null !== this.credentials_) { out.push(this.credentials_, &#x27;@&#x27;); }
        out.push(this.domain_);
        if (null !== this.port_) { out.push(&#x27;:&#x27;, this.port_.toString()); }
    }
    if (null !== this.path_) { out.push(this.path_); }
    if (null !== this.query_) { out.push(&#x27;?&#x27;, this.query_); }
    if (null !== this.fragment_) { out.push(&#x27;#&#x27;, this.fragment_); }
    return out.join(&#x27;&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 */
function create(scheme, credentials, domain, port, path, query, fragment) {
    var uri = new URI(
        encodeIfExists2(scheme, URI_DISALLOWED_IN_SCHEME_OR_CREDENTIALS_),
        encodeIfExists2(
            credentials, URI_DISALLOWED_IN_SCHEME_OR_CREDENTIALS_),
        encodeIfExists(domain),
        port &#x3e; 0 ? port.<span class="apidocCodeKeywordSpan">toString</span>() : null,
        encodeIfExists2(path, URI_DISALLOWED_IN_PATH_),
        null,
        encodeIfExists(fragment));
    if (query) {
        if (&#x27;string&#x27; === typeof query) {
            uri.setRawQuery(query.replace(/[^?&#x26;=0-9A-Za-z_\-~.%]/g, encodeOne));
        } else {
...</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
